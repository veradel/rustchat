# Chat Application (Rust)

Консольное приложение чата на языке Rust, реализующее одновременно клиент и сервер.

## Описание

Приложение позволяет запускать сервер чата и подключаться к нему с помощью клиентов. Сервер пересылает все сообщения всем подключенным клиентам. Сообщения, адресованные конкретному пользователю (с использованием @username), подсвечиваются в консоли.

## Возможности

- Асинхронный TCP сервер на базе Tokio
- Множественные клиентские подключения
- Broadcast сообщений всем клиентам
- Подсветка сообщений, адресованных пользователю (@username)
- Цветной вывод в консоли
- Обработка подключений и отключений клиентов

## Требования

- Rust 1.70 или выше
- Cargo (входит в состав Rust)

**Важно:** Для сборки и запуска проекта необходимо использовать команду `cargo` из корневой директории проекта (где находится `Cargo.toml`), а не `rustc` напрямую. Cargo автоматически управляет зависимостями и правильной версией edition.

## Установка

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd chat-app
```

2. Убедитесь, что Rust и Cargo установлены:
```bash
rustc --version
cargo --version
```

Если команды не найдены, установите Rust с официального сайта: https://www.rust-lang.org/tools/install

3. Соберите проект (из корневой директории проекта):
```bash
cargo build --release
```

**Важно:** Все команды `cargo` должны выполняться из корневой директории проекта (где находится `Cargo.toml`), а не из директории `src`.

## Использование

### Запуск сервера

Сервер слушает указанный TCP порт (по умолчанию 8080) и принимает подключения от клиентов.

**Синтаксис:**
```bash
cargo run -- server [OPTIONS]
```

**Параметры:**
- `-p, --port <PORT>` - Порт для прослушивания (по умолчанию: 8080)

**Примеры:**

Запуск сервера на порту по умолчанию (8080):
```bash
cargo run -- server
```

Запуск сервера на порту 3000:
```bash
cargo run -- server --port 3000
```

Или с коротким ключом:
```bash
cargo run -- server -p 3000
```

### Запуск клиента

Клиент подключается к серверу по указанному адресу и отправляет имя пользователя.

**Синтаксис:**
```bash
cargo run -- client [OPTIONS]
```

**Параметры:**
- `-a, --address <ADDRESS>` - Адрес сервера в формате `IP:PORT` (обязательно)
- `-u, --username <USERNAME>` - Имя пользователя (обязательно)

**Примеры:**

Подключение к локальному серверу:
```bash
cargo run -- client --address 127.0.0.1:8080 --username Alice
```

Или с короткими ключами:
```bash
cargo run -- client -a 127.0.0.1:8080 -u Bob
```

Подключение к удаленному серверу:
```bash
cargo run -- client -a 192.168.1.100:8080 -u Charlie
```

## Использование приложения

### Работа с клиентом

1. После подключения к серверу вы увидите подтверждение подключения
2. Введите сообщение и нажмите Enter для отправки
3. Все сообщения от других пользователей будут отображаться в консоли
4. Сообщения, адресованные вам (содержащие `@ваше_имя`), будут подсвечены желтым цветом
5. Ваши собственные сообщения отображаются голубым цветом
6. Для выхода введите `exit` или нажмите Ctrl+C

### Примеры сообщений

- Обычное сообщение: `Привет всем!`
- Личное сообщение: `@Alice Привет! Как дела?`
- Сообщение нескольким пользователям: `@Bob @Charlie Встречаемся в 15:00`

## Структура проекта

```
chat-app/
├── Cargo.toml          # Конфигурация проекта и зависимости
├── README.md           # Документация
├── run-server.bat      # Скрипт для запуска сервера (Windows)
├── run-client.bat      # Скрипт для запуска клиента (Windows)
└── src/
    └── main.rs         # Основной код приложения
```

## Быстрый старт (Windows)

Для удобства можно использовать готовые bat-файлы:

**Запуск сервера:**
```cmd
run-server.bat
```

**Запуск клиента:**
```cmd
run-client.bat Alice
```

## Зависимости

- **clap** (4.4) - Парсинг аргументов командной строки
- **tokio** (1.35) - Асинхронный runtime для Rust
- **tokio-util** (0.7) - Утилиты для Tokio (включая LinesCodec)
- **colored** (2.1) - Подсветка текста в консоли
- **futures** (0.3) - Асинхронные примитивы

## Особенности реализации

- Использование `broadcast` канала для рассылки сообщений всем клиентам
- Использование `select!` для параллельной обработки ввода/вывода без разделения `Framed`
- Асинхронная обработка множественных подключений
- Управление жизненным циклом клиентов (подключение/отключение)

## Скриншоты

1. Окно сервера с логами подключений и сообщений
![Image alt](/1.jpg)

2. Окно клиента с отправкой и получением сообщений
![Image alt](/2.jpg)

3. Демонстрацию подсветки сообщений с упоминанием (@username)
![Image alt](/3.jpg)




### Сервер
Сервер выводит логи о подключениях и отключениях клиентов, а также все получаемые сообщения.

### Клиент
Клиент отображает:
- Обычные сообщения - белым цветом
- Собственные сообщения - голубым цветом
- Сообщения с упоминанием (@username) - желтым цветом на черном фоне

## Примечания

- Для корректной работы необходимо сначала запустить сервер, затем клиенты
- Сервер может обрабатывать неограниченное количество одновременных подключений
- Сообщения передаются в реальном времени
- При отключении клиента сервер автоматически уведомляет остальных пользователей
